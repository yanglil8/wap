"use strict";(self["webpackChunkwap"]=self["webpackChunkwap"]||[]).push([[4312],{4312:function(t,s,i){i.r(s),i.d(s,{default:function(){return l}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"content-main"},[s("div",{staticClass:"flex divider"},[s("div",{staticClass:"headerTag"},[t._v("全部消息")]),s("div",{staticClass:"h-switch"},t._l(t.switchList,(function(i,e){return s("div",{key:e,staticClass:"h-switch-item",class:t.currentIndex==e&&"active",on:{click:function(s){return t.changeSwitch(i,e)}}},[t._v(t._s(i.ClassName))])})),0)]),s("div",{staticClass:"notify_search"},[s("van-icon",{attrs:{name:"search"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInfo.keyWord,expression:"searchInfo.keyWord"}],staticClass:"org_search_input",attrs:{placeholder:"请输入关键字"},domProps:{value:t.searchInfo.keyWord},on:{input:function(s){s.target.composing||t.$set(t.searchInfo,"keyWord",s.target.value)}}})],1),s("div",{staticClass:"notify_topic"},t._l(t.topicList,(function(i,e){return s("div",{key:e,staticClass:"notify_topic_item",style:t.currentType==i.Id&&{color:"#5284f7"},on:{click:function(s){return t.change(i)}}},[s("i",{staticClass:"iconfont",class:i.icon,style:t.currentType==i.Id&&{color:"#5284f7"}}),s("span",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(i.TopicName))])])})),0),s("ScrollView",{ref:"ScrollView",attrs:{top:"160px",bottom:"0"},on:{down:t.down,upFun:t.up}},t._l(t.dataList,(function(i,e){return s("div",{key:e,staticClass:"notify_list_item",on:{click:function(s){return t.toDetails(i)}}},[s("div",{staticClass:"notify_list_item_img"},[s("i",{staticClass:"iconfont icon-myNotice"})]),s("div",{staticClass:"notify_list_item_content"},[i.isRead?s("image",{staticClass:"notify_ststus",attrs:{src:"/static/img/status/status23.png",mode:"widthFix"}}):t._e(),i.isRead?t._e():s("image",{staticClass:"notify_ststus",attrs:{src:"/static/img/status/status24.png",mode:"widthFix"}}),s("div",{staticClass:"h_line_title hidden-one"},[t._v(" "+t._s(i.Title?i.Title:i.TaskName)+" ")]),s("div",{staticClass:"h_line_time"},[t._v(" "+t._s(t.$time(i.CreateTime).format("YYYY-MM-DD HH:mm"))+" ")])])])})),0)],1)},a=[],n={name:"Notice",props:{},components:{},data(){return{dataList:[],topicList:[{TopicName:"通知公告",Id:1,icon:"icontongzhi"},{TopicName:"审批中心",Id:3,icon:"iconshenpi"}],searchInfo:{keyWord:null,msgType:null},currentApi:"BD_MessageIndex",currentIndex:0,currentType:1,switchList:[],switchList1:[{ClassName:"未读",Id:0},{ClassName:"已读",Id:1},{ClassName:"全部",Id:null}],switchList3:[{ClassName:"待办",Id:0},{ClassName:"已办",Id:1},{ClassName:"全部",Id:2}]}},methods:{down(t){this.$refs["ScrollView"].reUp()},up([t,s]){this._api[this.currentApi]({...this.searchInfo,Page:t.num,PageSize:t.size}).then((i=>{if(i){let e=i.data;this.totalcount=i.totalcount,1===t.num&&(this.dataList=[]),this.dataList=this.dataList.concat(e),this.$nextTick((()=>{s.endSuccess(e.length)}))}}))},change(t){this.currentType=t.Id,this.currentIndex=0,this.switchList=this[`switchList${t.Id}`],this.searchInfo=this.$options.data().searchInfo,3==t.Id&&(this.searchInfo.st=this.switchList[0].Id,this.currentApi="WF_WorkflowTaskProcessMY"),1==t.Id&&(this.searchInfo.isRead=this.switchList[0].Id,this.currentApi="BD_MessageIndex"),this.dataList=[],this.$refs["ScrollView"].reUp()},changeSwitch(t,s){this.currentIndex=s,this.dataList=[],3==this.currentType&&(this.searchInfo.st=t.Id),1==this.currentType&&(this.searchInfo.isRead=t.Id),this.$refs["ScrollView"].reUp()},toDetails(t){3==t.MsgType?this._api.BD_MessageDetails({Id:t.Id}).then((s=>{if(s){if(t.isRead=1,s.data.Url.toUpperCase().includes("SHS")){let t=s.data.Url.split("/"),i=t[t.length-1].match(/TaskId=(\S*)/)[1];uni.navigateTo({url:"/pages/Module/shs/details/ShsDetails?TaskId="+i})}if(s.data.Url.toUpperCase().includes("PMP")||s.data.Url.includes("PMS")){let t=s.data.Url.split("/"),i=t[t.length-1],e=i.includes("ProjectId")?i.match(/ProjectId=(\S*)/)[1]:i.match(/Id=(\S*)/)[1];uni.navigateTo({url:"/pages/Module/pmp/details/PmpDetails?Id="+e})}}})):uni.navigateTo({url:"/pages/Module/details/NoticeDetails?Id="+t.Id})}},async mounted(){this.switchList=this.switchList1,await this.$nextTick()}},c=n,o=i(3736),r=(0,o.Z)(c,e,a,!1,null,null,null),l=r.exports}}]);
//# sourceMappingURL=4312.649af97c.js.map